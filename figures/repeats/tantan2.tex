\documentclass[11pt]{article}
\usepackage{epsfig}
\input shared.texm
\startfile
\begin{pspicture}(-2.6,-2.5)(8,2.5)
\def\MNODE(#1,#2)#3#4{%
\cnode(#1,#2){0.31}{#3}\rput(#1,#2){#4}}%
\def\PNODE(#1,#2)#3{%
\cnode[fillstyle=solid,fillcolor=black](#1,#2){0.1}{#3}}%
\def\XP{0.5}\def\XPP{1.5}\def\XS{2.5}
\def\XD{2.7}\def\XR{3.7}\def\XI{4.7}\def\XE{6.2}
\def\YR{0.6}\def\YRR{1.8}
\def\YD{1.2}
\def\YH{-2.5}\def\XH{2.1}

\MNODE(-\XS,0){s}{$s$}
\MNODE(-\XPP,0){p1}{$P_1$}
\MNODE(-\XP,0){p2}{$P_2$}
\MNODE(\XP,0){p3}{$P_3$}
\MNODE(\XPP,0){p4}{$P_4$}
\MNODE(\XR,\YRR){r1}{$R_1$}
\MNODE(\XR,\YR){r2}{$R_2$}
\MNODE(\XR,-\YR){r3}{$R_3$}
\MNODE(\XR,-\YRR){r4}{$R_4$}
\MNODE(\XD,\YD){d1}{$D_1$}
\MNODE(\XD,0){d2}{$D_2$}
\MNODE(\XD,-\YD){d3}{$D_3$}
\MNODE(\XI,\YD){i1}{$I_1$}
\MNODE(\XI,0){i2}{$I_2$}
\MNODE(\XI,-\YD){i3}{$I_3$}
\MNODE(\XE,0){e}{$e$}

\pnode(-\XPP,\YH){h1}
\pnode(-\XP,\YH){h2}
\pnode(\XP,\YH){h3}
\pnode(\XPP,\YH){h4}
\pnode(\XH,\YH){h5}
\pnode(\XH,-\YD){h6}
\pnode(\XH,0){h7}
\pnode(\XI,\YH){h8}

\psset{linecolor=darkgray}
\ncarc[arcangle=-45]{s}{h1}%
\ncline{p1}{h1}
\ncline{p2}{h2}
\ncline{p3}{h3}
\ncline{p4}{h4}
\ncarc[arcangle=-15]{d1}{h7}%
\ncline{d2}{h7}
\ncline{d3}{h6}

\ncline{h1}{h2}
\ncline{h2}{h3}
\ncline{h3}{h4}
\ncline{h4}{h5}
\ncline{h6}{h5}
\ncline{h7}{h6}
\ncline{h5}{h8}

\psset{arrows=->}
\ncarc[arcangle=-45]{h8}{e}
\ncline{s}{p1}
\ncline{p1}{p2}
\ncline{p2}{p3}
\ncline{p3}{p4}

\ncarc[arcangle=45]{r1}{e}
\ncarc[arcangle=15]{r2}{e}
\ncarc[arcangle=-15]{r3}{e}
\ncarc[arcangle=-45]{r4}{e}

\ncarc[arcangle=15]{p1}{r1}
\ncarc[arcangle=15]{p2}{r2}
\ncarc[arcangle=-20]{p3}{r3}
\ncarc[arcangle=-50]{p4}{r4}

\ncline{r1}{i1}
\ncline{r2}{i2}
\ncline{r2}{i2}
\ncline{r3}{i3}
\ncline{i1}{r2}
\ncline{i2}{r3}
\ncline{i3}{r4}
\ncline{i1}{i2}
\ncline{i2}{i3}

\ncline{r2}{d1}
\ncline{r3}{d2}
\ncline{r4}{d3}
\ncline{d1}{r1}
\ncline{d2}{r2}
\ncline{d3}{r3}
\ncline{d2}{d1}
\ncline{d3}{d2}

\ncline{i1}{e}
\ncline{i2}{e}
\ncline{i3}{e}



\nccircle[angle=0,nodesep=-1pt]{r1}{0.3}
\nccircle[angle=0,nodesep=-1pt]{r2}{0.3}
\nccircle[angle=0,nodesep=-1pt]{r3}{0.3}
\nccircle[angle=0,nodesep=-1pt]{r4}{0.3}

\end{pspicture}
\endfile
